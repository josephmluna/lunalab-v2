<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Luna Lab</title>
    <style>
        /* --- CSS VARIABLES & RESET --- */
        :root {
            --bg-color: #ffffff;
            --text-color: #333333;
            --accent-color: #003366;
            /* Academic Blue */
            --light-gray: #f4f4f4;
            --sidebar-width: 260px;
            --font-main: 'Helvetica Neue', Helvetica, Arial, sans-serif;
            --max-content-width: 900px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-main);
            color: var(--text-color);
            line-height: 1.6;
            min-height: 100vh;
        }

        a {
            text-decoration: none;
            color: inherit;
        }

        img {
            max-width: 100%;
            display: block;
        }

        /* --- LAYOUT CONTAINER --- */
        .layout-container {
            display: flex;
            min-height: 100vh;
        }

        /* --- SIDEBAR (HEADER) --- */
        header {
            width: var(--sidebar-width);
            background: var(--bg-color);
            border-right: 1px solid #eee;
            position: sticky;
            top: 0;
            height: 100vh;
            padding: 2rem;
            display: flex;
            flex-direction: column;
            gap: 2rem;
            flex-shrink: 0;
            overflow-y: auto;
        }

        .logo-area {
            width: 150px;
            height: 150px;
            background: var(--accent-color);
            /* Placeholder for actual logo */
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.2rem;
            margin-bottom: 1rem;
            border-radius: 4px;
            /* Slight rounded corners for logo box */
        }

        .site-title {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--accent-color);
            margin-bottom: 0.5rem;
        }

        nav {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .nav-links {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .nav-links a {
            font-weight: 500;
            color: #555;
            transition: color 0.2s, padding-left 0.2s;
        }

        .nav-links a:hover,
        .nav-links a.active-link {
            color: var(--accent-color);
            padding-left: 5px;
            font-weight: bold;
        }

        .hamburger {
            display: none;
        }

        /* --- MAIN CONTENT --- */
        main {
            flex: 1;
            padding: 4rem 6rem;
            /* Generous padding */
            max-width: var(--max-content-width);
            /* Removed margin: 0 auto to allow left justification relative to content area */
        }

        section {
            scroll-margin-top: 2rem;
            margin-bottom: 4rem;
            display: none;
            /* Hidden by default */
            animation: fadeIn 0.4s ease-out;
        }

        section.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(5px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        h2 {
            font-size: 2rem;
            margin-bottom: 2rem;
            color: var(--accent-color);
            font-weight: 300;
            /* Lighter weight for cleaner look */
            border-bottom: 1px solid #eee;
            padding-bottom: 0.5rem;
        }

        /* --- SECTIONS SPECIFIC --- */
        /* Hero */
        #home {
            padding-top: 2rem;
        }

        .hero-title {
            font-size: 2.8rem;
            margin-bottom: 1rem;
            color: var(--accent-color);
            line-height: 1.2;
        }

        .hero-sub {
            font-size: 1.4rem;
            color: #666;
            font-weight: 300;
            margin-bottom: 2rem;
        }

        /* Research */
        .research-card {
            margin-bottom: 3rem;
            padding-bottom: 2rem;
            border-bottom: 1px solid #f4f4f4;
        }

        .research-card:last-child {
            border-bottom: none;
        }

        .research-card h3 {
            margin-bottom: 1rem;
            font-size: 1.4rem;
        }

        .research-card img {
            margin: 1.5rem 0;
            border-radius: 4px;
            max-height: 400px;
            object-fit: contain;
            background: #fafafa;
        }

        /* People */
        .people-grid {
            display: flex;
            flex-direction: column;
            gap: 3rem;
        }

        .person-card {
            display: flex;
            gap: 2rem;
            align-items: start;
            text-align: left;
        }

        .person-img {
            width: 240px;
            /* Same as PI */
            aspect-ratio: 2 / 3;
            object-fit: cover;
            border-radius: 4px;
            /* Consistent with PI */
            flex-shrink: 0;
            background: #eee;
            filter: grayscale(20%);
            transition: filter 0.3s;
        }

        .person-img:hover {
            filter: grayscale(0%);
        }

        .person-info {
            display: flex;
            flex-direction: column;
            justify-content: center;
            padding-top: 1rem;
        }

        .person-name {
            font-weight: bold;
            font-size: 1.3rem;
            color: var(--accent-color);
            margin-bottom: 0.2rem;
        }

        .person-role {
            font-weight: 500;
            font-size: 1rem;
            color: #555;
            margin-bottom: 1rem;
        }

        .person-bio {
            color: #666;
            line-height: 1.6;
        }

        /* PI Section adjustments */
        .pi-container {
            display: flex;
            gap: 2rem;
            /* Consistent gap */
            margin-bottom: 4rem;
            align-items: start;
        }

        .pi-img {
            width: 240px;
            aspect-ratio: 2 / 3;
            object-fit: cover;
            border-radius: 4px;
            flex-shrink: 0;
        }

        /* Publications */
        .pub-list {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        .pub-item {
            /* Cleaner look, no side border */
        }

        .pub-title {
            font-weight: 600;
            font-size: 1.1rem;
            margin-bottom: 0.3rem;
        }

        .pub-title a:hover {
            text-decoration: underline;
            color: var(--accent-color);
        }

        .pub-meta {
            font-family: serif;
            color: #555;
        }

        /* News */
        .news-item {
            margin-bottom: 2rem;
            border-left: 2px solid var(--light-gray);
            padding-left: 1.5rem;
        }

        .news-date {
            font-weight: bold;
            font-size: 0.9rem;
            color: #888;
            display: block;
            margin-bottom: 0.5rem;
        }

        /* Footer */
        footer {
            margin-top: 4rem;
            padding-top: 2rem;
            border-top: 1px solid #eee;
            font-size: 0.85rem;
            color: #999;
        }

        /* --- RESPONSIVE --- */
        @media (max-width: 900px) {
            main {
                padding: 3rem;
            }
        }

        @media (max-width: 768px) {
            .layout-container {
                flex-direction: column;
            }

            header {
                width: 100%;
                height: auto;
                position: relative;
                flex-direction: row;
                justify-content: space-between;
                align-items: center;
                padding: 1rem;
                border-right: none;
                border-bottom: 1px solid #ddd;
            }

            .logo-area {
                width: 40px;
                height: 40px;
                margin-bottom: 0;
                font-size: 0.8rem;
            }

            .site-title {
                display: none;
            }

            /* Hide title if logo serves purpose, or adjust */

            nav {
                width: auto;
            }

            .nav-links {
                display: none;
                position: absolute;
                top: 100%;
                left: 0;
                right: 0;
                background: white;
                padding: 1rem;
                box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
                z-index: 100;
            }

            .nav-links.active {
                display: flex;
            }

            .hamburger {
                display: block;
                font-size: 1.5rem;
                cursor: pointer;
            }

            main {
                padding: 2rem 1.5rem;
            }

            .pi-container {
                flex-direction: column;
                gap: 1.5rem;
            }

            .pi-img {
                width: 100%;
                max-width: 300px;
            }
        }
    </style>
</head>

<body>

    <div class="layout-container">

        <header>
            <div>
                <div class="logo-area">LOGO</div>
                <div class="site-title"><a href="#home">Luna Lab</a></div>
                <div style="font-size: 0.9rem; color: #666; margin-bottom: 1.5rem;">Case Western Reserve University
                </div>
            </div>

            <nav>
                <div class="hamburger" onclick="toggleMenu()">â˜°</div>
                <div class="nav-links" id="nav-links">
                    <!-- Links injected by JS -->
                </div>
            </nav>
        </header>

        <main id="main-content">
            <!-- Content injected by JS -->

            <footer>
                <p>&copy; <span id="year"></span> <span id="footer-title"></span></p>
            </footer>
        </main>

    </div>

    <script>
        // Toggle Mobile Menu
        function toggleMenu() {
            document.querySelector('.nav-links').classList.toggle('active');
        }

        // Fetch and Render Data
        async function loadData() {
            try {
                const response = await fetch('data.json');
                const data = await response.json();
                renderSite(data);
            } catch (error) {
                console.error('Error loading data.json:', error);
                document.body.innerHTML = '<h1 style="text-align:center; margin-top:2rem;">Error loading content. Please ensure data.json is present.</h1>';
            }
        }

        var renderSite = function (data) {
            // Meta
            document.title = data.meta.title;
            // Site title injection handled in HTML static part for sidebar, but we can update text if needed
            // document.querySelector('.site-title a').innerText = data.meta.title; 
            document.getElementById('footer-title').innerText = data.meta.title;
            document.getElementById('year').innerText = new Date().getFullYear();

            // Navigation
            const navContainer = document.getElementById('nav-links');
            navContainer.innerHTML = ''; // Clear existing
            data.meta.nav_links.forEach(link => {
                const a = document.createElement('a');
                a.href = `#${link.target}`;
                a.innerText = link.name;
                a.dataset.target = link.target; // Store target for styling
                a.onclick = () => {
                    document.querySelector('.nav-links').classList.remove('active'); // Close menu on click
                    // Active Styling Update will be handled by hashchange/showSection
                };
                navContainer.appendChild(a);
            });

            // Main Content Building
            const main = document.getElementById('main-content');
            // Clear main content (except footer if we want to preserve it, but we are appending sections before it usually)
            // Ideally we separate footer from dynamic injection or just re-inject.
            // Let's grab footer to append later or just keep it at bottom.
            const footer = document.querySelector('footer');

            // Remove old dynamic sections if any (for safety if re-running)
            document.querySelectorAll('section').forEach(e => e.remove());

            // 1. Home / Hero
            if (data.home) {
                const section = document.createElement('section');
                section.id = 'home';
                section.innerHTML = `
                    <h1 class="hero-title">${data.home.hero_text}</h1>
                    <p class="hero-sub">${data.home.sub_text}</p>
                    <div style="margin-top:3rem; max-width:700px; line-height: 1.8; font-size: 1.05rem;">
                        <p>${data.home.intro}</p>
                    </div>
                `;
                main.insertBefore(section, footer);
            }

            // 2. Research
            if (data.research) {
                const section = document.createElement('section');
                section.id = 'research';
                section.innerHTML = `<h2>Research</h2><div class="research-container"></div>`;
                const container = section.querySelector('.research-container');
                data.research.forEach(item => {
                    container.innerHTML += `
                        <div class="research-card">
                            <h3>${item.title}</h3>
                            <p>${item.text}</p>
                            ${item.image ? `<img src="${item.image}" alt="${item.title}">` : ''}
                        </div>
                    `;
                });
                main.insertBefore(section, footer);
            }

            // 3. People
            if (data.people) {
                const section = document.createElement('section');
                section.id = 'people';
                section.innerHTML = `<h2>People</h2>`;

                // PI
                if (data.people.principal_investigator) {
                    const pi = data.people.principal_investigator[0];
                    section.innerHTML += `
                        <div class="pi-container">
                            <div class="pi-img" style="background-image: url('${pi.image}'); background-size: cover; background-position: center;"></div>
                            <div>
                                <h3 style="font-size: 1.5rem;">${pi.name}</h3>
                                <p style="color:var(--accent-color); font-weight:bold; margin-bottom: 1rem;">${pi.role}</p>
                                <p style="line-height:1.7;">${pi.bio}</p>
                            </div>
                        </div>
                    `;
                }

                // Members
                if (data.people.members && data.people.members.length > 0) {
                    let membersHtml = `<div class="people-grid">`;
                    data.people.members.forEach(member => {
                        membersHtml += `
                            <div class="person-card">
                                <div class="person-img" style="background-image: url('${member.image}'); background-size: cover; background-position: center;"></div>
                                <div class="person-info">
                                    <div class="person-name">${member.name}</div>
                                    <div class="person-role">${member.role}</div>
                                    <div class="person-bio">${member.bio || ''}</div>
                                </div>
                            </div>
                        `;
                    });
                    membersHtml += `</div>`;
                    section.innerHTML += membersHtml;
                }
                main.insertBefore(section, footer);
            }

            // 4. Publications
            if (data.publications) {
                const section = document.createElement('section');
                section.id = 'publications';
                section.innerHTML = `<h2>Publications</h2><div class="pub-list"></div>`;
                const list = section.querySelector('.pub-list');
                data.publications.forEach(pub => {
                    list.innerHTML += `
                        <div class="pub-item">
                            <div class="pub-title"><a href="${pub.link}" target="_blank">${pub.title}</a></div>
                            <div class="pub-meta">${pub.authors} (${pub.year}) - ${pub.journal}</div>
                        </div>
                    `;
                });
                main.insertBefore(section, footer);
            }

            // 5. News
            if (data.news) {
                const section = document.createElement('section');
                section.id = 'news';
                section.innerHTML = `<h2>News</h2>`;
                data.news.forEach(item => {
                    section.innerHTML += `
                        <div class="news-item">
                            <span class="news-date">${item.date}</span>
                            <p>${item.text}</p>
                        </div>
                    `;
                });
                main.insertBefore(section, footer);
            }

            // 6. Contact
            if (data.contact) {
                const section = document.createElement('section');
                section.id = 'contact';
                section.innerHTML = `
                    <h2>Contact</h2>
                    <div class="contact-info" style="font-size: 1.1rem; line-height: 1.8;">
                        <p><strong>Email:</strong> <a href="mailto:${data.contact.email}" style="color:var(--accent-color)">${data.contact.email}</a></p>
                        <p><strong>Address:</strong><br> ${data.contact.address.replace(/,/g, '<br>')}</p>
                        <p><strong>Example Social:</strong> <a href="${data.contact.twitter}" target="_blank">Twitter/X</a></p>
                    </div>
                `;
                main.insertBefore(section, footer);
            }

            // Trigger hash check now that content is built
            handleHashChange();
        };

        // --- Navigation Logic ---
        function showSection(sectionId) {
            // 1. Hide all sections
            document.querySelectorAll('section').forEach(sec => {
                sec.classList.remove('active');
            });

            // 2. Update Nav State
            document.querySelectorAll('.nav-links a').forEach(link => {
                link.classList.remove('active-link');
                if (link.dataset.target === sectionId) link.classList.add('active-link');
            });

            // 3. Show target section
            const target = document.getElementById(sectionId);
            if (target) {
                target.classList.add('active');
                window.scrollTo(0, 0);
            } else {
                const home = document.getElementById('home');
                if (home) {
                    home.classList.add('active');
                    // update nav for home
                    const homeLink = document.querySelector('.nav-links a[data-target="home"]');
                    if (homeLink) homeLink.classList.add('active-link');
                }
            }
        }

        function handleHashChange() {
            const hash = window.location.hash.substring(1);
            if (hash) {
                showSection(hash);
            } else {
                showSection('home');
            }
        }

        window.addEventListener('hashchange', handleHashChange);

        // Initialize
        loadData();
    </script>
</body>

</html>