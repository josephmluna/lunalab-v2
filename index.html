<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Luna Lab</title>
    <style>
        /* --- CSS VARIABLES & RESET --- */
        :root {
            --bg-color: #ffffff;
            --text-color: #333333;
            --accent-color: #003366; /* Academic Blue */
            --light-gray: #f4f4f4;
            --font-main: 'Helvetica Neue', Helvetica, Arial, sans-serif;
            --max-width: 1000px;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: var(--font-main); color: var(--text-color); line-height: 1.6; }
        a { text-decoration: none; color: inherit; }
        img { max-width: 100%; display: block; }
        
        /* --- LAYOUT --- */
        header {
            background: var(--bg-color);
            border-bottom: 1px solid #ddd;
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        nav {
            max-width: var(--max-width);
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 2rem;
        }

        .logo { font-weight: bold; font-size: 1.5rem; color: var(--accent-color); }
        
        .nav-links { display: flex; gap: 2rem; }
        .nav-links a { font-weight: 500; transition: color 0.3s; }
        .nav-links a:hover { color: var(--accent-color); }

        /* Mobile Menu */
        .hamburger { display: none; cursor: pointer; font-size: 1.5rem; }
        
        main { max-width: var(--max-width); margin: 0 auto; padding: 2rem; }
        
        section { 
            scroll-margin-top: 80px; 
            margin-bottom: 4rem; 
            display: none; /* Hidden by default */
            animation: fadeIn 0.5s ease-in-out;
        }
        section.active { display: block; }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        h2 { font-size: 2rem; margin-bottom: 1.5rem; border-bottom: 2px solid var(--light-gray); padding-bottom: 0.5rem; color: var(--accent-color); }
        
        /* --- SECTIONS --- */
        /* Hero */
        #home { text-align: center; padding: 4rem 0; }
        .hero-title { font-size: 3rem; margin-bottom: 1rem; color: var(--accent-color); }
        .hero-sub { font-size: 1.5rem; color: #666; font-weight: 300; }
        
        /* Research */
        .research-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 2rem; }
        .research-card { background: var(--light-gray); padding: 1.5rem; border-radius: 8px; }
        .research-card h3 { margin-bottom: 1rem; }
        
        /* People */
        .people-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 2rem; }
        .person-card { text-align: center; }
        .person-img { width: 150px; height: 150px; border-radius: 50%; object-fit: cover; margin: 0 auto 1rem; background: #ddd; }
        .person-name { font-weight: bold; font-size: 1.1rem; }
        .person-role { font-size: 0.9rem; color: #666; }

        /* Publications */
        .pub-list { display: flex; flex-direction: column; gap: 1rem; }
        .pub-item { padding-left: 1rem; border-left: 3px solid var(--accent-color); }
        .pub-title { font-weight: bold; }
        .pub-meta { font-style: italic; color: #555; }
        
        /* News */
        .news-item { margin-bottom: 1.5rem; }
        .news-date { font-weight: bold; color: var(--accent-color); display: block; margin-bottom: 0.25rem; }
        
        /* Contact */
        .contact-info p { margin-bottom: 0.5rem; }

        /* Footer */
        footer { text-align: center; padding: 2rem; background: var(--light-gray); margin-top: 4rem; font-size: 0.9rem; color: #666; }

        /* --- RESPONSIVE --- */
        @media (max-width: 768px) {
            .nav-links { 
                display: none; 
                flex-direction: column; 
                position: absolute; 
                top: 100%; 
                left: 0; 
                right: 0; 
                background: white; 
                padding: 1rem; 
                box-shadow: 0 4px 6px rgba(0,0,0,0.1); 
            }
            .nav-links.active { display: flex; }
            .hamburger { display: block; }
            .hero-title { font-size: 2rem; }
        }
    </style>
</head>
<body>

    <header>
        <nav>
            <a href="#" class="logo" id="site-title">Lab Name</a>
            <div class="hamburger" onclick="toggleMenu()">â˜°</div>
            <div class="nav-links" id="nav-links">
                <!-- Links injected by JS -->
            </div>
        </nav>
    </header>

    <main id="main-content">
        <!-- Content injected by JS -->
    </main>

    <footer>
        <p>&copy; <span id="year"></span> <span id="footer-title"></span></p>
    </footer>

    <script>
        // Toggle Mobile Menu
        function toggleMenu() {
            document.querySelector('.nav-links').classList.toggle('active');
        }

        // Fetch and Render Data
        async function loadData() {
            try {
                const response = await fetch('data.json');
                const data = await response.json();
                renderSite(data);
            } catch (error) {
                console.error('Error loading data.json:', error);
                document.body.innerHTML = '<h1 style="text-align:center; margin-top:2rem;">Error loading content. Please ensure data.json is present.</h1>';
            }
        }

        function renderSite(data) {
            // Meta
            document.title = data.meta.title;
            document.getElementById('site-title').innerText = data.meta.title;
            document.getElementById('footer-title').innerText = data.meta.title;
            document.getElementById('year').innerText = new Date().getFullYear();

            // Navigation
            const navContainer = document.getElementById('nav-links');
            data.meta.nav_links.forEach(link => {
                const a = document.createElement('a');
                a.href = `#${link.target}`;
                a.innerText = link.name;
                a.onclick = () => document.querySelector('.nav-links').classList.remove('active'); // Close menu on click
                navContainer.appendChild(a);
            });

            // Main Content Building
            const main = document.getElementById('main-content');
            
            // 1. Home / Hero
            if (data.home) {
                const section = document.createElement('section');
                section.id = 'home';
                section.innerHTML = `
                    <h1 class="hero-title">${data.home.hero_text}</h1>
                    <p class="hero-sub">${data.home.sub_text}</p>
                    <div style="margin-top:2rem; max-width:800px; margin-left:auto; margin-right:auto;">
                        <p>${data.home.intro}</p>
                    </div>
                `;
                main.appendChild(section);
            }

            // 2. Research
            if (data.research) {
                const section = document.createElement('section');
                section.id = 'research';
                section.innerHTML = `<h2>Research</h2><div class="research-grid"></div>`;
                const grid = section.querySelector('.research-grid');
                data.research.forEach(item => {
                    grid.innerHTML += `
                        <div class="research-card">
                            <h3>${item.title}</h3>
                            <p>${item.text}</p>
                        </div>
                    `;
                });
                main.appendChild(section);
            }

            // 3. People
            if (data.people) {
                const section = document.createElement('section');
                section.id = 'people';
                section.innerHTML = `<h2>People</h2>`;
                
                // PI
                if (data.people.principal_investigator) {
                    const pi = data.people.principal_investigator[0];
                    section.innerHTML += `
                        <div style="margin-bottom: 3rem; text-align:center;">
                            <div class="person-img" style="background-image: url('${pi.image}'); background-size: cover;"></div>
                            <h3>${pi.name}</h3>
                            <p style="color:var(--accent-color)">${pi.role}</p>
                            <p style="max-width:600px; margin: 1rem auto;">${pi.bio}</p>
                        </div>
                    `;
                }

                // Members
                if (data.people.members && data.people.members.length > 0) {
                    let membersHtml = `<div class="people-grid">`;
                    data.people.members.forEach(member => {
                        membersHtml += `
                            <div class="person-card">
                                <div class="person-img" style="background-image: url('${member.image}'); background-size: cover;"></div>
                                <div class="person-name">${member.name}</div>
                                <div class="person-role">${member.role}</div>
                            </div>
                        `;
                    });
                    membersHtml += `</div>`;
                    section.innerHTML += membersHtml;
                }
                main.appendChild(section);
            }

            // 4. Publications
            if (data.publications) {
                const section = document.createElement('section');
                section.id = 'publications';
                section.innerHTML = `<h2>Publications</h2><div class="pub-list"></div>`;
                const list = section.querySelector('.pub-list');
                data.publications.forEach(pub => {
                    list.innerHTML += `
                        <div class="pub-item">
                            <div class="pub-title"><a href="${pub.link}" target="_blank">${pub.title}</a></div>
                            <div class="pub-meta">${pub.authors} (${pub.year}) - ${pub.journal}</div>
                        </div>
                    `;
                });
                main.appendChild(section);
            }

            // 5. News
            if (data.news) {
                const section = document.createElement('section');
                section.id = 'news';
                section.innerHTML = `<h2>News</h2>`;
                data.news.forEach(item => {
                    section.innerHTML += `
                        <div class="news-item">
                            <span class="news-date">${item.date}</span>
                            <p>${item.text}</p>
                        </div>
                    `;
                });
                main.appendChild(section);
            }

            // 6. Contact
            if (data.contact) {
                const section = document.createElement('section');
                section.id = 'contact';
                section.innerHTML = `
                    <h2>Contact</h2>
                    <div class="contact-info">
                        <p><strong>Email:</strong> <a href="mailto:${data.contact.email}">${data.contact.email}</a></p>
                        <p><strong>Address:</strong> ${data.contact.address}</p>
                        <p><strong>Twitter/X:</strong> <a href="${data.contact.twitter}" target="_blank">Link</a></p>
                    </div>
                `;
                main.appendChild(section);
            }
        }
        
        // Call handleHashChange after render to show initial section
        renderSite = (function(original) {
            return function(data) {
                original(data);
                handleHashChange();
            };
        })(renderSite);

        // Initialize
        loadData();

        // --- Navigation Logic ---
        function showSection(sectionId) {
            // 1. Hide all sections
            document.querySelectorAll('section').forEach(sec => {
                sec.classList.remove('active');
            });

            // 2. Show target section
            const target = document.getElementById(sectionId);
            if (target) {
                target.classList.add('active');
                window.scrollTo(0, 0); // Scroll to top on section change
            } else {
                // Default to home if section not found (or if hash is empty/invalid)
                const home = document.getElementById('home');
                if (home) home.classList.add('active');
            }
        }

        function handleHashChange() {
            const hash = window.location.hash.substring(1); // Remove '#'
            if (hash) {
                showSection(hash);
            } else {
                showSection('home');
            }
        }

        // Listen for hash changes
        window.addEventListener('hashchange', handleHashChange);

    </script>
</body>
</html>
